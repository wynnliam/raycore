#include "fcscalar.h"
#include "./util.h"

#define PROJ_W 320
#define PROJ_H 200
#define UNIT_SIZE 64

extern int z_buffer_2d[PROJ_W][PROJ_H];
extern int fc_proj_dist[200][361];
extern int fc_proj_dist_sqrt[200][361];
extern int fc_fe[200][361];

static void (*scalarf[100]) (fcd* fcd) = {
&draw_fc_100,
&draw_fc_101,
&draw_fc_102,
&draw_fc_103,
&draw_fc_104,
&draw_fc_105,
&draw_fc_106,
&draw_fc_107,
&draw_fc_108,
&draw_fc_109,
&draw_fc_110,
&draw_fc_111,
&draw_fc_112,
&draw_fc_113,
&draw_fc_114,
&draw_fc_115,
&draw_fc_116,
&draw_fc_117,
&draw_fc_118,
&draw_fc_119,
&draw_fc_120,
&draw_fc_121,
&draw_fc_122,
&draw_fc_123,
&draw_fc_124,
&draw_fc_125,
&draw_fc_126,
&draw_fc_127,
&draw_fc_128,
&draw_fc_129,
&draw_fc_130,
&draw_fc_131,
&draw_fc_132,
&draw_fc_133,
&draw_fc_134,
&draw_fc_135,
&draw_fc_136,
&draw_fc_137,
&draw_fc_138,
&draw_fc_139,
&draw_fc_140,
&draw_fc_141,
&draw_fc_142,
&draw_fc_143,
&draw_fc_144,
&draw_fc_145,
&draw_fc_146,
&draw_fc_147,
&draw_fc_148,
&draw_fc_149,
&draw_fc_150,
&draw_fc_151,
&draw_fc_152,
&draw_fc_153,
&draw_fc_154,
&draw_fc_155,
&draw_fc_156,
&draw_fc_157,
&draw_fc_158,
&draw_fc_159,
&draw_fc_160,
&draw_fc_161,
&draw_fc_162,
&draw_fc_163,
&draw_fc_164,
&draw_fc_165,
&draw_fc_166,
&draw_fc_167,
&draw_fc_168,
&draw_fc_169,
&draw_fc_170,
&draw_fc_171,
&draw_fc_172,
&draw_fc_173,
&draw_fc_174,
&draw_fc_175,
&draw_fc_176,
&draw_fc_177,
&draw_fc_178,
&draw_fc_179,
&draw_fc_180,
&draw_fc_181,
&draw_fc_182,
&draw_fc_183,
&draw_fc_184,
&draw_fc_185,
&draw_fc_186,
&draw_fc_187,
&draw_fc_188,
&draw_fc_189,
&draw_fc_190,
&draw_fc_191,
&draw_fc_192,
&draw_fc_193,
&draw_fc_194,
&draw_fc_195,
&draw_fc_196,
&draw_fc_197,
&draw_fc_198,
&draw_fc_199};

void draw_fc(const int bottom, fcd* fcd) {
  if(bottom < 0 || bottom >= 200)
    return;
  scalarf[bottom - 100](fcd); 
}

void draw_fc_100(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[100][ray_angle_relative_to_player_rot];
  f = fc_fe[100][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-100 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 100 * PROJ_W + sc;
  ceiling_screen_pixel = (-100 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-100 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[101][ray_angle_relative_to_player_rot];
  f = fc_fe[101][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-101 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 101 * PROJ_W + sc;
  ceiling_screen_pixel = (-101 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-101 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[102][ray_angle_relative_to_player_rot];
  f = fc_fe[102][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-102 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 102 * PROJ_W + sc;
  ceiling_screen_pixel = (-102 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-102 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[103][ray_angle_relative_to_player_rot];
  f = fc_fe[103][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-103 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 103 * PROJ_W + sc;
  ceiling_screen_pixel = (-103 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-103 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[104][ray_angle_relative_to_player_rot];
  f = fc_fe[104][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-104 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 104 * PROJ_W + sc;
  ceiling_screen_pixel = (-104 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-104 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[105][ray_angle_relative_to_player_rot];
  f = fc_fe[105][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-105 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 105 * PROJ_W + sc;
  ceiling_screen_pixel = (-105 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-105 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[106][ray_angle_relative_to_player_rot];
  f = fc_fe[106][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-106 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 106 * PROJ_W + sc;
  ceiling_screen_pixel = (-106 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-106 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_101(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[101][ray_angle_relative_to_player_rot];
  f = fc_fe[101][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-101 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 101 * PROJ_W + sc;
  ceiling_screen_pixel = (-101 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-101 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[102][ray_angle_relative_to_player_rot];
  f = fc_fe[102][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-102 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 102 * PROJ_W + sc;
  ceiling_screen_pixel = (-102 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-102 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[103][ray_angle_relative_to_player_rot];
  f = fc_fe[103][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-103 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 103 * PROJ_W + sc;
  ceiling_screen_pixel = (-103 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-103 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[104][ray_angle_relative_to_player_rot];
  f = fc_fe[104][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-104 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 104 * PROJ_W + sc;
  ceiling_screen_pixel = (-104 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-104 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[105][ray_angle_relative_to_player_rot];
  f = fc_fe[105][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-105 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 105 * PROJ_W + sc;
  ceiling_screen_pixel = (-105 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-105 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[106][ray_angle_relative_to_player_rot];
  f = fc_fe[106][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-106 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 106 * PROJ_W + sc;
  ceiling_screen_pixel = (-106 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-106 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_102(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[102][ray_angle_relative_to_player_rot];
  f = fc_fe[102][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-102 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 102 * PROJ_W + sc;
  ceiling_screen_pixel = (-102 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-102 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[103][ray_angle_relative_to_player_rot];
  f = fc_fe[103][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-103 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 103 * PROJ_W + sc;
  ceiling_screen_pixel = (-103 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-103 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[104][ray_angle_relative_to_player_rot];
  f = fc_fe[104][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-104 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 104 * PROJ_W + sc;
  ceiling_screen_pixel = (-104 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-104 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[105][ray_angle_relative_to_player_rot];
  f = fc_fe[105][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-105 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 105 * PROJ_W + sc;
  ceiling_screen_pixel = (-105 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-105 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[106][ray_angle_relative_to_player_rot];
  f = fc_fe[106][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-106 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 106 * PROJ_W + sc;
  ceiling_screen_pixel = (-106 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-106 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_103(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[103][ray_angle_relative_to_player_rot];
  f = fc_fe[103][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-103 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 103 * PROJ_W + sc;
  ceiling_screen_pixel = (-103 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-103 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[104][ray_angle_relative_to_player_rot];
  f = fc_fe[104][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-104 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 104 * PROJ_W + sc;
  ceiling_screen_pixel = (-104 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-104 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[105][ray_angle_relative_to_player_rot];
  f = fc_fe[105][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-105 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 105 * PROJ_W + sc;
  ceiling_screen_pixel = (-105 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-105 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[106][ray_angle_relative_to_player_rot];
  f = fc_fe[106][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-106 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 106 * PROJ_W + sc;
  ceiling_screen_pixel = (-106 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-106 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_104(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[104][ray_angle_relative_to_player_rot];
  f = fc_fe[104][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-104 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 104 * PROJ_W + sc;
  ceiling_screen_pixel = (-104 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-104 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[105][ray_angle_relative_to_player_rot];
  f = fc_fe[105][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-105 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 105 * PROJ_W + sc;
  ceiling_screen_pixel = (-105 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-105 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[106][ray_angle_relative_to_player_rot];
  f = fc_fe[106][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-106 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 106 * PROJ_W + sc;
  ceiling_screen_pixel = (-106 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-106 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_105(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[105][ray_angle_relative_to_player_rot];
  f = fc_fe[105][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-105 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 105 * PROJ_W + sc;
  ceiling_screen_pixel = (-105 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-105 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[106][ray_angle_relative_to_player_rot];
  f = fc_fe[106][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-106 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 106 * PROJ_W + sc;
  ceiling_screen_pixel = (-106 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-106 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_106(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[106][ray_angle_relative_to_player_rot];
  f = fc_fe[106][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-106 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 106 * PROJ_W + sc;
  ceiling_screen_pixel = (-106 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-106 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_107(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[107][ray_angle_relative_to_player_rot];
  f = fc_fe[107][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-107 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 107 * PROJ_W + sc;
  ceiling_screen_pixel = (-107 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-107 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_108(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[108][ray_angle_relative_to_player_rot];
  f = fc_fe[108][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-108 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 108 * PROJ_W + sc;
  ceiling_screen_pixel = (-108 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-108 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_109(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[109][ray_angle_relative_to_player_rot];
  f = fc_fe[109][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-109 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 109 * PROJ_W + sc;
  ceiling_screen_pixel = (-109 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-109 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_110(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[110][ray_angle_relative_to_player_rot];
  f = fc_fe[110][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-110 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 110 * PROJ_W + sc;
  ceiling_screen_pixel = (-110 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-110 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_111(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[111][ray_angle_relative_to_player_rot];
  f = fc_fe[111][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-111 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 111 * PROJ_W + sc;
  ceiling_screen_pixel = (-111 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-111 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_112(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[112][ray_angle_relative_to_player_rot];
  f = fc_fe[112][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-112 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 112 * PROJ_W + sc;
  ceiling_screen_pixel = (-112 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-112 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_113(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[113][ray_angle_relative_to_player_rot];
  f = fc_fe[113][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-113 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 113 * PROJ_W + sc;
  ceiling_screen_pixel = (-113 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-113 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_114(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[114][ray_angle_relative_to_player_rot];
  f = fc_fe[114][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-114 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 114 * PROJ_W + sc;
  ceiling_screen_pixel = (-114 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-114 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_115(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[115][ray_angle_relative_to_player_rot];
  f = fc_fe[115][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-115 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 115 * PROJ_W + sc;
  ceiling_screen_pixel = (-115 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-115 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_116(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[116][ray_angle_relative_to_player_rot];
  f = fc_fe[116][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-116 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 116 * PROJ_W + sc;
  ceiling_screen_pixel = (-116 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-116 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_117(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[117][ray_angle_relative_to_player_rot];
  f = fc_fe[117][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-117 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 117 * PROJ_W + sc;
  ceiling_screen_pixel = (-117 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-117 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_118(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[118][ray_angle_relative_to_player_rot];
  f = fc_fe[118][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-118 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 118 * PROJ_W + sc;
  ceiling_screen_pixel = (-118 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-118 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_119(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[119][ray_angle_relative_to_player_rot];
  f = fc_fe[119][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-119 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 119 * PROJ_W + sc;
  ceiling_screen_pixel = (-119 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-119 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_120(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[120][ray_angle_relative_to_player_rot];
  f = fc_fe[120][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-120 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 120 * PROJ_W + sc;
  ceiling_screen_pixel = (-120 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-120 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_121(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[121][ray_angle_relative_to_player_rot];
  f = fc_fe[121][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-121 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 121 * PROJ_W + sc;
  ceiling_screen_pixel = (-121 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-121 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_122(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[122][ray_angle_relative_to_player_rot];
  f = fc_fe[122][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-122 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 122 * PROJ_W + sc;
  ceiling_screen_pixel = (-122 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-122 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_123(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[123][ray_angle_relative_to_player_rot];
  f = fc_fe[123][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-123 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 123 * PROJ_W + sc;
  ceiling_screen_pixel = (-123 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-123 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_124(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[124][ray_angle_relative_to_player_rot];
  f = fc_fe[124][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-124 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 124 * PROJ_W + sc;
  ceiling_screen_pixel = (-124 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-124 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_125(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[125][ray_angle_relative_to_player_rot];
  f = fc_fe[125][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-125 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 125 * PROJ_W + sc;
  ceiling_screen_pixel = (-125 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-125 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_126(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[126][ray_angle_relative_to_player_rot];
  f = fc_fe[126][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-126 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 126 * PROJ_W + sc;
  ceiling_screen_pixel = (-126 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-126 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_127(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[127][ray_angle_relative_to_player_rot];
  f = fc_fe[127][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-127 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 127 * PROJ_W + sc;
  ceiling_screen_pixel = (-127 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-127 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_128(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[128][ray_angle_relative_to_player_rot];
  f = fc_fe[128][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-128 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 128 * PROJ_W + sc;
  ceiling_screen_pixel = (-128 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-128 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_129(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[129][ray_angle_relative_to_player_rot];
  f = fc_fe[129][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-129 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 129 * PROJ_W + sc;
  ceiling_screen_pixel = (-129 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-129 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_130(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[130][ray_angle_relative_to_player_rot];
  f = fc_fe[130][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-130 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 130 * PROJ_W + sc;
  ceiling_screen_pixel = (-130 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-130 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_131(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[131][ray_angle_relative_to_player_rot];
  f = fc_fe[131][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-131 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 131 * PROJ_W + sc;
  ceiling_screen_pixel = (-131 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-131 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_132(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[132][ray_angle_relative_to_player_rot];
  f = fc_fe[132][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-132 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 132 * PROJ_W + sc;
  ceiling_screen_pixel = (-132 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-132 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_133(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[133][ray_angle_relative_to_player_rot];
  f = fc_fe[133][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-133 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 133 * PROJ_W + sc;
  ceiling_screen_pixel = (-133 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-133 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_134(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[134][ray_angle_relative_to_player_rot];
  f = fc_fe[134][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-134 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 134 * PROJ_W + sc;
  ceiling_screen_pixel = (-134 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-134 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_135(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[135][ray_angle_relative_to_player_rot];
  f = fc_fe[135][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-135 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 135 * PROJ_W + sc;
  ceiling_screen_pixel = (-135 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-135 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_136(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[136][ray_angle_relative_to_player_rot];
  f = fc_fe[136][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-136 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 136 * PROJ_W + sc;
  ceiling_screen_pixel = (-136 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-136 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_137(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[137][ray_angle_relative_to_player_rot];
  f = fc_fe[137][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-137 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 137 * PROJ_W + sc;
  ceiling_screen_pixel = (-137 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-137 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_138(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[138][ray_angle_relative_to_player_rot];
  f = fc_fe[138][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-138 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 138 * PROJ_W + sc;
  ceiling_screen_pixel = (-138 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-138 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_139(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[139][ray_angle_relative_to_player_rot];
  f = fc_fe[139][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-139 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 139 * PROJ_W + sc;
  ceiling_screen_pixel = (-139 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-139 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_140(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[140][ray_angle_relative_to_player_rot];
  f = fc_fe[140][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-140 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 140 * PROJ_W + sc;
  ceiling_screen_pixel = (-140 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-140 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_141(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[141][ray_angle_relative_to_player_rot];
  f = fc_fe[141][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-141 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 141 * PROJ_W + sc;
  ceiling_screen_pixel = (-141 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-141 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_142(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[142][ray_angle_relative_to_player_rot];
  f = fc_fe[142][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-142 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 142 * PROJ_W + sc;
  ceiling_screen_pixel = (-142 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-142 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_143(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[143][ray_angle_relative_to_player_rot];
  f = fc_fe[143][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-143 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 143 * PROJ_W + sc;
  ceiling_screen_pixel = (-143 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-143 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_144(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[144][ray_angle_relative_to_player_rot];
  f = fc_fe[144][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-144 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 144 * PROJ_W + sc;
  ceiling_screen_pixel = (-144 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-144 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_145(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[145][ray_angle_relative_to_player_rot];
  f = fc_fe[145][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-145 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 145 * PROJ_W + sc;
  ceiling_screen_pixel = (-145 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-145 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_146(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[146][ray_angle_relative_to_player_rot];
  f = fc_fe[146][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-146 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 146 * PROJ_W + sc;
  ceiling_screen_pixel = (-146 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-146 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_147(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[147][ray_angle_relative_to_player_rot];
  f = fc_fe[147][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-147 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 147 * PROJ_W + sc;
  ceiling_screen_pixel = (-147 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-147 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_148(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[148][ray_angle_relative_to_player_rot];
  f = fc_fe[148][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-148 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 148 * PROJ_W + sc;
  ceiling_screen_pixel = (-148 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-148 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_149(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[149][ray_angle_relative_to_player_rot];
  f = fc_fe[149][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-149 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 149 * PROJ_W + sc;
  ceiling_screen_pixel = (-149 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-149 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_150(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[150][ray_angle_relative_to_player_rot];
  f = fc_fe[150][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-150 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 150 * PROJ_W + sc;
  ceiling_screen_pixel = (-150 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-150 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_151(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[151][ray_angle_relative_to_player_rot];
  f = fc_fe[151][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-151 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 151 * PROJ_W + sc;
  ceiling_screen_pixel = (-151 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-151 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_152(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[152][ray_angle_relative_to_player_rot];
  f = fc_fe[152][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-152 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 152 * PROJ_W + sc;
  ceiling_screen_pixel = (-152 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-152 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_153(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[153][ray_angle_relative_to_player_rot];
  f = fc_fe[153][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-153 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 153 * PROJ_W + sc;
  ceiling_screen_pixel = (-153 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-153 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_154(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[154][ray_angle_relative_to_player_rot];
  f = fc_fe[154][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-154 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 154 * PROJ_W + sc;
  ceiling_screen_pixel = (-154 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-154 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_155(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[155][ray_angle_relative_to_player_rot];
  f = fc_fe[155][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-155 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 155 * PROJ_W + sc;
  ceiling_screen_pixel = (-155 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-155 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_156(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[156][ray_angle_relative_to_player_rot];
  f = fc_fe[156][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-156 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 156 * PROJ_W + sc;
  ceiling_screen_pixel = (-156 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-156 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_157(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[157][ray_angle_relative_to_player_rot];
  f = fc_fe[157][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-157 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 157 * PROJ_W + sc;
  ceiling_screen_pixel = (-157 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-157 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_158(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[158][ray_angle_relative_to_player_rot];
  f = fc_fe[158][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-158 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 158 * PROJ_W + sc;
  ceiling_screen_pixel = (-158 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-158 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_159(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[159][ray_angle_relative_to_player_rot];
  f = fc_fe[159][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-159 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 159 * PROJ_W + sc;
  ceiling_screen_pixel = (-159 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-159 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_160(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[160][ray_angle_relative_to_player_rot];
  f = fc_fe[160][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-160 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 160 * PROJ_W + sc;
  ceiling_screen_pixel = (-160 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-160 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_161(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[161][ray_angle_relative_to_player_rot];
  f = fc_fe[161][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-161 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 161 * PROJ_W + sc;
  ceiling_screen_pixel = (-161 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-161 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_162(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[162][ray_angle_relative_to_player_rot];
  f = fc_fe[162][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-162 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 162 * PROJ_W + sc;
  ceiling_screen_pixel = (-162 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-162 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_163(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[163][ray_angle_relative_to_player_rot];
  f = fc_fe[163][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-163 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 163 * PROJ_W + sc;
  ceiling_screen_pixel = (-163 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-163 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_164(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[164][ray_angle_relative_to_player_rot];
  f = fc_fe[164][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-164 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 164 * PROJ_W + sc;
  ceiling_screen_pixel = (-164 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-164 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_165(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[165][ray_angle_relative_to_player_rot];
  f = fc_fe[165][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-165 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 165 * PROJ_W + sc;
  ceiling_screen_pixel = (-165 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-165 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_166(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[166][ray_angle_relative_to_player_rot];
  f = fc_fe[166][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-166 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 166 * PROJ_W + sc;
  ceiling_screen_pixel = (-166 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-166 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_167(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[167][ray_angle_relative_to_player_rot];
  f = fc_fe[167][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-167 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 167 * PROJ_W + sc;
  ceiling_screen_pixel = (-167 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-167 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_168(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[168][ray_angle_relative_to_player_rot];
  f = fc_fe[168][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-168 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 168 * PROJ_W + sc;
  ceiling_screen_pixel = (-168 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-168 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_169(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[169][ray_angle_relative_to_player_rot];
  f = fc_fe[169][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-169 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 169 * PROJ_W + sc;
  ceiling_screen_pixel = (-169 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-169 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_170(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[170][ray_angle_relative_to_player_rot];
  f = fc_fe[170][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-170 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 170 * PROJ_W + sc;
  ceiling_screen_pixel = (-170 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-170 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_171(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[171][ray_angle_relative_to_player_rot];
  f = fc_fe[171][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-171 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 171 * PROJ_W + sc;
  ceiling_screen_pixel = (-171 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-171 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_172(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[172][ray_angle_relative_to_player_rot];
  f = fc_fe[172][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-172 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 172 * PROJ_W + sc;
  ceiling_screen_pixel = (-172 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-172 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_173(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[173][ray_angle_relative_to_player_rot];
  f = fc_fe[173][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-173 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 173 * PROJ_W + sc;
  ceiling_screen_pixel = (-173 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-173 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_174(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[174][ray_angle_relative_to_player_rot];
  f = fc_fe[174][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-174 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 174 * PROJ_W + sc;
  ceiling_screen_pixel = (-174 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-174 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_175(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[175][ray_angle_relative_to_player_rot];
  f = fc_fe[175][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-175 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 175 * PROJ_W + sc;
  ceiling_screen_pixel = (-175 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-175 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_176(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[176][ray_angle_relative_to_player_rot];
  f = fc_fe[176][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-176 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 176 * PROJ_W + sc;
  ceiling_screen_pixel = (-176 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-176 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_177(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[177][ray_angle_relative_to_player_rot];
  f = fc_fe[177][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-177 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 177 * PROJ_W + sc;
  ceiling_screen_pixel = (-177 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-177 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_178(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[178][ray_angle_relative_to_player_rot];
  f = fc_fe[178][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-178 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 178 * PROJ_W + sc;
  ceiling_screen_pixel = (-178 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-178 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_179(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[179][ray_angle_relative_to_player_rot];
  f = fc_fe[179][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-179 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 179 * PROJ_W + sc;
  ceiling_screen_pixel = (-179 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-179 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_180(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[180][ray_angle_relative_to_player_rot];
  f = fc_fe[180][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-180 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 180 * PROJ_W + sc;
  ceiling_screen_pixel = (-180 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-180 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_181(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[181][ray_angle_relative_to_player_rot];
  f = fc_fe[181][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-181 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 181 * PROJ_W + sc;
  ceiling_screen_pixel = (-181 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-181 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_182(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[182][ray_angle_relative_to_player_rot];
  f = fc_fe[182][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-182 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 182 * PROJ_W + sc;
  ceiling_screen_pixel = (-182 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-182 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_183(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[183][ray_angle_relative_to_player_rot];
  f = fc_fe[183][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-183 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 183 * PROJ_W + sc;
  ceiling_screen_pixel = (-183 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-183 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_184(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[184][ray_angle_relative_to_player_rot];
  f = fc_fe[184][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-184 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 184 * PROJ_W + sc;
  ceiling_screen_pixel = (-184 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-184 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_185(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[185][ray_angle_relative_to_player_rot];
  f = fc_fe[185][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-185 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 185 * PROJ_W + sc;
  ceiling_screen_pixel = (-185 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-185 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_186(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[186][ray_angle_relative_to_player_rot];
  f = fc_fe[186][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-186 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 186 * PROJ_W + sc;
  ceiling_screen_pixel = (-186 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-186 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_187(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[187][ray_angle_relative_to_player_rot];
  f = fc_fe[187][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-187 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 187 * PROJ_W + sc;
  ceiling_screen_pixel = (-187 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-187 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_188(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[188][ray_angle_relative_to_player_rot];
  f = fc_fe[188][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-188 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 188 * PROJ_W + sc;
  ceiling_screen_pixel = (-188 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-188 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_189(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[189][ray_angle_relative_to_player_rot];
  f = fc_fe[189][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-189 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 189 * PROJ_W + sc;
  ceiling_screen_pixel = (-189 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-189 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_190(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[190][ray_angle_relative_to_player_rot];
  f = fc_fe[190][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-190 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 190 * PROJ_W + sc;
  ceiling_screen_pixel = (-190 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-190 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_191(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[191][ray_angle_relative_to_player_rot];
  f = fc_fe[191][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-191 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 191 * PROJ_W + sc;
  ceiling_screen_pixel = (-191 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-191 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_192(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[192][ray_angle_relative_to_player_rot];
  f = fc_fe[192][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-192 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 192 * PROJ_W + sc;
  ceiling_screen_pixel = (-192 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-192 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_193(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[193][ray_angle_relative_to_player_rot];
  f = fc_fe[193][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-193 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 193 * PROJ_W + sc;
  ceiling_screen_pixel = (-193 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-193 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_194(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[194][ray_angle_relative_to_player_rot];
  f = fc_fe[194][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-194 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 194 * PROJ_W + sc;
  ceiling_screen_pixel = (-194 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-194 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_195(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[195][ray_angle_relative_to_player_rot];
  f = fc_fe[195][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-195 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 195 * PROJ_W + sc;
  ceiling_screen_pixel = (-195 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-195 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_196(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[196][ray_angle_relative_to_player_rot];
  f = fc_fe[196][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-196 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 196 * PROJ_W + sc;
  ceiling_screen_pixel = (-196 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-196 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_197(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[197][ray_angle_relative_to_player_rot];
  f = fc_fe[197][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-197 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 197 * PROJ_W + sc;
  ceiling_screen_pixel = (-197 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-197 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_198(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[198][ray_angle_relative_to_player_rot];
  f = fc_fe[198][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-198 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 198 * PROJ_W + sc;
  ceiling_screen_pixel = (-198 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-198 + PROJ_H] = f;
    }
  }
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
void draw_fc_199(fcd* fcd) {
  const int sc = fcd->sc;
  const int sv = fcd->sv;
  const int cv = fcd->cv;
  const int player_x = fcd->player_x;
  const int player_y = fcd->player_y;
  const int ray_angle_relative_to_player_rot = fcd->ray_angle_relative_to_player_rot;
  struct mapdef* map = fcd->map;
  unsigned int* fcp = fcd->fcp;
  int dist_to_point;
  int f;
  unsigned int wx, wy, t;
  int zbv;
  int tx, ty;
  int floor_screen_pixel;
  int ceiling_screen_pixel;
  unsigned int index;
  dist_to_point = fc_proj_dist[199][ray_angle_relative_to_player_rot];
  f = fc_fe[199][ray_angle_relative_to_player_rot];
  wx = player_x + ((dist_to_point * cv) >> 7);
  wy = player_y - ((dist_to_point * sv) >> 7);
  t = get_tile(wx, wy, map);
  zbv = z_buffer_2d[sc][-199 + PROJ_H];
  tx = wx % UNIT_SIZE;
  ty = wy % UNIT_SIZE;
  floor_screen_pixel = 199 * PROJ_W + sc;
  ceiling_screen_pixel = (-199 + PROJ_H) * PROJ_W + sc;
  index = (ty << 6) + tx;
  if(t < map->num_floor_ceils) {
    if(map->floor_ceils[t].dataf)
      fcp[floor_screen_pixel] = map->floor_ceils[t].dataf[index];
    if(map->floor_ceils[t].datac && (zbv == -1 || zbv > f)) {
      fcp[ceiling_screen_pixel] = map->floor_ceils[t].datac[index];
      z_buffer_2d[sc][-199 + PROJ_H] = f;
    }
  }
}
